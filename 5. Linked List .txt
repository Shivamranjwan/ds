class Node:
    def __init__(self, roll, name, marks):
        self.roll, self.name, self.marks = roll, name, marks
        self.next = None


class StudentList:
    def __init__(self):
        self.head = None


    def add(self, roll, name, marks):
        new = Node(roll, name, marks)
        if not self.head: self.head = new; return
        temp = self.head
        while temp.next: temp = temp.next
        temp.next = new


    def delete(self, roll):
        temp, prev = self.head, None
        while temp and temp.roll != roll: prev, temp = temp, temp.next
        if not temp: print("Record not found!"); return
        if not prev: self.head = temp.next
        else: prev.next = temp.next
        print("Record deleted!")


    def update(self, roll, name=None, marks=None):
        temp = self.head
        while temp:
            if temp.roll == roll:
                if name: temp.name = name
                if marks is not None: temp.marks = marks
                print("Record updated!"); return
            temp = temp.next
        print("Record not found!")


    def search(self, roll):
        temp = self.head
        while temp:
            if temp.roll == roll:
                print(f"Found -> Roll:{temp.roll}, Name:{temp.name}, Marks:{temp.marks}"); return
            temp = temp.next
        print("Record not found!")


    def display(self):
        if not self.head: print("No records!"); return
        temp = self.head
        while temp:
            print(f"Roll:{temp.roll}, Name:{temp.name}, Marks:{temp.marks}")
            temp = temp.next


    def sort(self, key="roll", reverse=False):
        arr, temp = [], self.head
        while temp: arr.append((temp.roll, temp.name, temp.marks)); temp = temp.next
        idx = 0 if key=="roll" else 2
        arr.sort(key=lambda x: x[idx], reverse=reverse)
        self.head = None
        for r in arr: self.add(*r)




sl = StudentList()
while True:
    print("\n1.Add  2.Delete  3.Update  4.Search  5.Display  6.Sort  7.Exit")
    ch = input("Enter choice: ")
    if ch=="1":
        sl.add(int(input("Roll: ")), input("Name: "), int(input("Marks: ")))
    elif ch=="2":
        sl.delete(int(input("Enter Roll to delete: ")))
    elif ch=="3":
        sl.update(int(input("Roll: ")), input("New Name (or blank): ") or None,
                  int(input("New Marks (or -1): ")) if input("Update Marks? (y/n): ")=="y" else None)
    elif ch=="4":
        sl.search(int(input("Enter Roll: ")))
    elif ch=="5":
        sl.display()
    elif ch=="6":
        key = input("Sort by roll/marks? ")
        order = input("Ascending/Descending (a/d)? ")
        sl.sort(key=key, reverse=(order=="d"))
        print("Sorted!")
    elif ch=="7":
        break
    else: print("Invalid choice!")